# Marstek Battery System - Lovelace Dashboard Example
# Copy this YAML into your Lovelace dashboard editor

# Main Battery Status Card
type: vertical-stack
cards:
  # Battery Overview
  - type: glance
    title: Marstek Battery System
    entities:
      - entity: sensor.marstek_battery_state_of_charge
        name: Battery
      - entity: sensor.marstek_battery_power
        name: Power
      - entity: sensor.marstek_battery_temperature
        name: Temperature
      - entity: sensor.marstek_grid_power
        name: Grid

  # Power Flow Card (requires custom:power-flow-card-plus or similar)
  - type: custom:power-flow-card-plus
    entities:
      battery:
        entity: sensor.marstek_battery_power
        state_of_charge: sensor.marstek_battery_state_of_charge
      grid:
        entity: sensor.marstek_grid_power
      solar:
        entity: sensor.marstek_solar_power  # Venus D only
      home:
        entity: sensor.marstek_off_grid_power

  # Operating Mode Control
  - type: entities
    title: Control
    entities:
      - entity: select.marstek_operating_mode
        name: Operating Mode
      - entity: number.marstek_passive_power
        name: Passive Power Setting
      - entity: binary_sensor.marstek_battery_charging
        name: Charging
      - entity: binary_sensor.marstek_battery_discharging
        name: Discharging

  # Energy Statistics
  - type: entities
    title: Energy Statistics
    entities:
      - entity: sensor.marstek_total_solar_energy
        name: Total Solar Generated
      - entity: sensor.marstek_total_grid_output_energy
        name: Total Grid Export
      - entity: sensor.marstek_total_grid_input_energy
        name: Total Grid Import
      - entity: sensor.marstek_total_load_energy
        name: Total Load Consumption

  # Battery Details
  - type: entities
    title: Battery Details
    entities:
      - entity: sensor.marstek_battery_capacity
        name: Current Capacity
      - entity: sensor.marstek_battery_rated_capacity
        name: Rated Capacity
      - entity: sensor.marstek_battery_temperature
        name: Temperature
      - entity: sensor.marstek_battery_state_of_charge
        name: State of Charge

  # Solar Information (Venus D only)
  - type: entities
    title: Solar Panel
    entities:
      - entity: sensor.marstek_solar_power
        name: Power
      - entity: sensor.marstek_solar_voltage
        name: Voltage
      - entity: sensor.marstek_solar_current
        name: Current

  # Energy Meter (if CT connected)
  - type: entities
    title: Energy Meter
    entities:
      - entity: binary_sensor.marstek_ct_connected
        name: CT Connected
      - entity: sensor.marstek_total_meter_power
        name: Total Power
      - entity: sensor.marstek_phase_a_power
        name: Phase A
      - entity: sensor.marstek_phase_b_power
        name: Phase B
      - entity: sensor.marstek_phase_c_power
        name: Phase C

  # Network Status
  - type: entities
    title: Network Status
    entities:
      - entity: sensor.marstek_wifi_signal_strength
        name: WiFi Signal
      - entity: binary_sensor.marstek_bluetooth_connected
        name: Bluetooth

# Alternative: Compact Single Card View
---
type: entities
title: Marstek Battery System
entities:
  - type: section
    label: Status
  - entity: sensor.marstek_battery_state_of_charge
  - entity: sensor.marstek_battery_power
  - entity: sensor.marstek_grid_power
  - entity: select.marstek_operating_mode
  
  - type: section
    label: Energy Today
  - entity: sensor.marstek_daily_solar
  - entity: sensor.marstek_daily_grid_import
  - entity: sensor.marstek_daily_grid_export

# Gauge Cards for Visual Display
---
type: horizontal-stack
cards:
  - type: gauge
    entity: sensor.marstek_battery_state_of_charge
    name: Battery Level
    min: 0
    max: 100
    severity:
      green: 60
      yellow: 30
      red: 0
    needle: true

  - type: gauge
    entity: sensor.marstek_battery_temperature
    name: Battery Temp
    min: 0
    max: 60
    severity:
      green: 0
      yellow: 40
      red: 50
    needle: true

# History Graph
---
type: history-graph
title: Marstek Power History
entities:
  - entity: sensor.marstek_battery_power
    name: Battery
  - entity: sensor.marstek_grid_power
    name: Grid
  - entity: sensor.marstek_solar_power
    name: Solar
hours_to_show: 24
refresh_interval: 0

# Statistics Card
---
type: statistics-graph
title: Marstek Energy Statistics
entities:
  - entity: sensor.marstek_battery_power
  - entity: sensor.marstek_grid_power
  - entity: sensor.marstek_solar_power
days_to_show: 7
stat_types:
  - mean
  - max
  - min

# Markdown Card for Quick Actions
---
type: markdown
title: Quick Actions
content: |
  ### Quick Mode Changes
  
  **Auto Mode**
  ```yaml
  service: select.select_option
  target:
    entity_id: select.marstek_operating_mode
  data:
    option: Auto
  ```
  
  **Force Charge (2kW)**
  ```yaml
  service: script.marstek_force_charge
  ```
  
  **Force Discharge (1.5kW)**
  ```yaml
  service: script.marstek_force_discharge
  ```

# Button Card for Mode Control (requires custom:button-card)
---
type: custom:button-card
entity: select.marstek_operating_mode
name: Operating Mode
tap_action:
  action: more-info
hold_action:
  action: none
styles:
  card:
    - height: 100px
  icon:
    - width: 50px
  name:
    - font-size: 16px
state:
  - value: 'Auto'
    icon: mdi:auto-fix
    color: green
  - value: 'AI'
    icon: mdi:robot
    color: blue
  - value: 'Manual'
    icon: mdi:hand-back-right
    color: orange
  - value: 'Passive'
    icon: mdi:flash
    color: red

# Mini Graph Card (requires custom:mini-graph-card)
---
type: custom:mini-graph-card
name: Battery Power Flow
entities:
  - entity: sensor.marstek_battery_power
    name: Battery
    color: '#3498db'
  - entity: sensor.marstek_grid_power
    name: Grid
    color: '#e74c3c'
  - entity: sensor.marstek_solar_power
    name: Solar
    color: '#f39c12'
hours_to_show: 24
line_width: 2
points_per_hour: 4
animate: true
show:
  labels: true
  points: false
  legend: true

# Apex Charts (requires custom:apexcharts-card)
---
type: custom:apexcharts-card
header:
  show: true
  title: Marstek Energy Flow
  show_states: true
graph_span: 24h
series:
  - entity: sensor.marstek_battery_power
    name: Battery
    type: area
    color: '#2196F3'
  - entity: sensor.marstek_grid_power
    name: Grid
    type: line
    color: '#F44336'
  - entity: sensor.marstek_solar_power
    name: Solar
    type: area
    color: '#FFC107'
